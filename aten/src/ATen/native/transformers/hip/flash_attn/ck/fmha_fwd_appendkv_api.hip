// SPDX-License-Identifier: MIT
// Copyright (c) 2018-2024, Advanced Micro Devices, Inc. All rights reserved.

// auto generated by generate.py
#include "fmha_fwd.hpp"

float fmha_fwd_appendkv(fmha_fwd_appendkv_traits t, fmha_fwd_appendkv_args a, const ck_tile::stream_config& s){
    float r = -1;
    if(t.data_type.compare("fp16") == 0){
        if (t.hdim_q <= 32 && t.hdim_v <= 32) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 32 == 0) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 32 == 0) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::fp16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }
        else if (t.hdim_q <= 64 && t.hdim_v <= 64) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 64 == 0) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 64 == 0) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::fp16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }
        else if (t.hdim_q <= 128 && t.hdim_v <= 128) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 128 == 0) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 128 == 0) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::fp16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }
        else if (t.hdim_q <= 256 && t.hdim_v <= 256) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 256 == 0) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 256 == 0) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::fp16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }

    }
    else if(t.data_type.compare("bf16") == 0){
        if (t.hdim_q <= 32 && t.hdim_v <= 32) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 32 == 0) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 32 == 0) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 32 != 0*/) && (a.hdim_v % 32 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 32 != 0*/) && (true /*a.hdim_v % 32 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<32, ck_tile::bf16_t, 64, 64, 32, 32, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }
        else if (t.hdim_q <= 64 && t.hdim_v <= 64) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 64 == 0) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 64 == 0) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 64 != 0*/) && (a.hdim_v % 64 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 64 != 0*/) && (true /*a.hdim_v % 64 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<64, ck_tile::bf16_t, 64, 64, 64, 64, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }
        else if (t.hdim_q <= 128 && t.hdim_v <= 128) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 128 == 0) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 128 == 0) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 128 != 0*/) && (a.hdim_v % 128 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 128 != 0*/) && (true /*a.hdim_v % 128 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<128, ck_tile::bf16_t, 64, 64, 128, 128, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }
        else if (t.hdim_q <= 256 && t.hdim_v <= 256) {
            if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 256 == 0) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == true)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, true>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (a.hdim_q % 256 == 0) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, false, true, false, false, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::none) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::NONE, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::interleaved) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::INTERLEAVED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (a.seqlen_q % 64 == 0) && (true) && (true /*a.hdim_q % 256 != 0*/) && (a.hdim_v % 256 == 0) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, false, true, true, false, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }
            else if((t.is_v_rowmajor == true) &&
                        (true /*a.seqlen_q % 64 != 0*/) && (true) && (true /*a.hdim_q % 256 != 0*/) && (true /*a.hdim_v % 256 != 0*/) && (t.rope_type == rope_enum::half_rotated) &&
                        ((a.block_table_ptr != nullptr) == false)) {
                using trait_ = fmha_fwd_appendkv_traits_<256, ck_tile::bf16_t, 64, 64, 256, 256, true, true, true, true, true, ck_tile::RotaryEmbeddingEnum::HALF_ROTATED, false>;
                return fmha_fwd_appendkv_<trait_>(s, a);
            }

        }

    }

    return r;
}
